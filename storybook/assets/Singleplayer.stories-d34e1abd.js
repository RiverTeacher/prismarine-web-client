import{j as l,a as f}from"./jsx-runtime-37f7df21.js";import{R as J,r as m}from"./index-f1f2c4b1.js";import{u as H,c as A,B as T}from"./utils-69ebb831.js";import{f as Q}from"./index.esm-b23235d8.js";import{T as ee}from"./Tabs-efacbebc.js";import"./DiveTransition-4aefebca.js";import"./inheritsLoose-c82a83d4.js";import"./index-c74c9f7f.js";const te=""+new URL("isles-5c297034.png",import.meta.url).href;/**
 * filesize
 *
 * @copyright 2023 Jason Mulligan <jason.mulligan@avoidwork.com>
 * @license BSD-3-Clause
 * @version 10.0.12
 */const ie="array",ne="bit",F="bits",re="byte",Y="bytes",R="",oe="exponent",le="function",I="iec",se="Invalid number",ce="Invalid rounding method",M="jedec",ae="object",$=".",de="round",ue="s",fe="kbit",me="kB",pe=" ",ge="string",ye="0",V={symbol:{iec:{bits:["bit","Kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],bytes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},jedec:{bits:["bit","Kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],bytes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}},fullform:{iec:["","kibi","mebi","gibi","tebi","pebi","exbi","zebi","yobi"],jedec:["","kilo","mega","giga","tera","peta","exa","zetta","yotta"]}};function _e(t,{bits:i=!1,pad:o=!1,base:n=-1,round:s=2,locale:p=R,localeOptions:g={},separator:u=R,spacer:v=pe,symbols:C={},standard:c=R,output:a=ge,fullform:D=!1,fullforms:b=[],exponent:_=-1,roundingMethod:N=de,precision:B=0}={}){let r=_,h=Number(t),e=[],d=0,S=R;n===-1&&c.length===0?(n=10,c=M):n===-1&&c.length>0?(c=c===I?I:M,n=c===I?2:10):(n=n===2?2:10,c=n===10||c===M?M:I);const w=n===10?1e3:1024,E=D===!0,k=h<0,O=Math[N];if(typeof t!="bigint"&&isNaN(t))throw new TypeError(se);if(typeof O!==le)throw new TypeError(ce);if(k&&(h=-h),(r===-1||isNaN(r))&&(r=Math.floor(Math.log(h)/Math.log(w)),r<0&&(r=0)),r>8&&(B>0&&(B+=8-r),r=8),a===oe)return r;if(h===0)e[0]=0,S=e[1]=V.symbol[c][i?F:Y][r];else{d=h/(n===2?Math.pow(2,r*10):Math.pow(1e3,r)),i&&(d=d*8,d>=w&&r<8&&(d=d/w,r++));const x=Math.pow(10,r>0?s:0);e[0]=O(d*x)/x,e[0]===w&&r<8&&_===-1&&(e[0]=1,r++),S=e[1]=n===10&&r===1?i?fe:me:V.symbol[c][i?F:Y][r]}if(k&&(e[0]=-e[0]),B>0&&(e[0]=e[0].toPrecision(B)),e[1]=C[e[1]]||e[1],p===!0?e[0]=e[0].toLocaleString():p.length>0?e[0]=e[0].toLocaleString(p,g):u.length>0&&(e[0]=e[0].toString().replace($,u)),o&&Number.isInteger(e[0])===!1&&s>0){const x=u||$,L=e[0].toString().split(x),P=L[1]||R,j=P.length,X=s-j;e[0]=`${L[0]}${x}${P.padEnd(j+X,ye)}`}return E&&(e[1]=b[r]?b[r]:V.fullform[c][r]+(i?ne:re)+(e[0]===1?R:ue)),a===ie?e:a===ae?{value:e[0],symbol:e[1],exponent:r,unit:S}:e.join(v)}function q(t,i){var o,n;if(t===i)return!0;if(t&&i&&(o=t.constructor)===i.constructor){if(o===Date)return t.getTime()===i.getTime();if(o===RegExp)return t.toString()===i.toString();if(o===Array&&(n=t.length)===i.length){for(;n--&&q(t[n],i[n]););return n===-1}if(o===Object){if(Object.keys(t).length!==Object.keys(i).length)return!1;for(n in t)if(!(n in i)||!q(t[n],i[n]))return!1;return!0}}return t!==t&&i!==i}function he(t){const i=J.useRef([]);return q(t,i.current)||(i.current=t),i.current}function we(t,i){return J.useMemo(t,he(i))}function ve(t,i,o,n){const s=m.useRef(o);s.current=o;const p=we(()=>n,[n]);m.useEffect(()=>{if(!t)return;const g=u=>s.current.call(t,u);return t.addEventListener(i,g,p),()=>{t.removeEventListener(i,g,p)}},[t,i,p])}const be="_root_7zg5y_1",Se="_content_7zg5y_7",Ee="_content_loading_7zg5y_20",Ne="_world_root_7zg5y_24",Te="_world_info_7zg5y_31",Be="_world_image_7zg5y_37",Re="_image_missing_7zg5y_41",Ce="_world_focused_7zg5y_44",De="_title_7zg5y_48",y={root:be,content:Se,content_loading:Ee,world_root:Ne,world_info:Te,world_image:Be,image_missing:Re,world_focused:Ce,title:De},ke="_container_acsky_1",xe="_input_acsky_10",G={container:ke,input:xe},Me=({autoFocus:t,rootStyles:i,...o})=>{const n=m.useRef(null),s=H();return m.useEffect(()=>{!t||s||n.current.focus()},[]),l("div",{className:G.container,style:i,children:l("input",{ref:n,className:G.input,autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",autoSave:"off",spellCheck:"false",...o})})};try{Input.displayName="Input",Input.__docgenInfo={description:"",displayName:"Input",props:{rootStyles:{defaultValue:null,description:"",name:"rootStyles",required:!1,type:{name:"CSSProperties"}},autoFocus:{defaultValue:null,description:"",name:"autoFocus",required:!1,type:{name:"boolean"}}}}}catch{}const Ie=({name:t,isFocused:i,title:o,lastPlayed:n,size:s,detail:p="",onFocus:g,onInteraction:u,iconBase64:v})=>{const C=m.useMemo(()=>{if(!n)return;const a=new Intl.RelativeTimeFormat("en",{numeric:"auto"}),D=Date.now()-n,b=Math.floor(D/1e3/60),_=Math.floor(b/60),N=Math.floor(_/24);return N>0?a.format(-N,"day"):_>0?a.format(-_,"hour"):a.format(-b,"minute")},[n]),c=m.useMemo(()=>{if(s)return _e(s)},[s]);return f("div",{className:A(y.world_root,i?y.world_focused:void 0),tabIndex:0,onFocus:()=>g==null?void 0:g(t),onKeyDown:a=>{(a.code==="Enter"||a.code==="Space")&&(a.preventDefault(),u==null||u(a.code==="Enter"?"enter":"space"))},onDoubleClick:()=>u==null?void 0:u("enter"),children:[l("img",{className:`${y.world_image} ${v?"":y.image_missing}`,src:v?`data:image/png;base64,${v}`:te,alt:"world preview"}),f("div",{className:y.world_info,children:[l("div",{className:y.world_title,title:"level.dat world name",children:o}),f("div",{className:"muted",children:[C," ",p.slice(-30)]}),l("div",{className:"muted",children:c})]})]})},W=({worldData:t,onGeneralAction:i,onWorldAction:o,activeProvider:n,setActiveProvider:s,providerActions:p,providers:g,disabledProviders:u,error:v,isReadonly:C,warning:c,warningAction:a,warningActionLabel:D})=>{const b=m.useRef(),_=m.useRef(null);ve(window,"keydown",e=>{if(e.code==="ArrowDown"||e.code==="ArrowUp"){e.preventDefault();const d=e.code==="ArrowDown"?1:-1,S=Q(b.current),w=S.indexOf(document.activeElement);if(w===-1)return;const E=S[w+d];E==null||E.focus()}});const[N,B]=m.useState(""),[r,h]=m.useState("");return m.useEffect(()=>{h("")},[n]),f("div",{ref:b,children:[l("div",{className:"dirt-bg"}),f("div",{className:A("fullscreen",y.root),children:[f("div",{style:{display:"flex",flexDirection:"column"},children:[l("span",{className:A("screen-title",y.title),children:"Select Saved World"}),l(Me,{autoFocus:!0,value:N,onChange:({target:{value:e}})=>B(e)})]}),f("div",{className:A(y.content,!t&&y.content_loading),children:[l(ee,{tabs:Object.keys(g),disabledTabs:u,activeTab:n??"",labels:g,onTabChange:e=>{s==null||s(e)},fullSize:!0}),f("div",{style:{marginTop:3},children:[p&&f("div",{style:{display:"flex",alignItems:"center"},children:[l("span",{style:{fontSize:9,marginRight:3},children:"Actions: "})," ",Object.entries(p).map(([e,d])=>typeof d=="function"?l(T,{onClick:d,style:{width:100},children:e},e):l(m.Fragment,{children:d},e))]}),t?t.filter(e=>e.title.toLowerCase().includes(N.toLowerCase())).map(({name:e,size:d,detail:S,...w})=>m.createElement(Ie,{...w,size:d,name:e,onFocus:h,isFocused:r===e,key:e,onInteraction:E=>{var k;E==="enter"?o("load",e):E==="space"&&((k=_.current)==null||k.focus())},detail:S})):l("div",{style:{fontSize:10,color:v?"red":"lightgray"},children:v||"Loading (check #dev console if loading too long)..."}),c&&f("div",{style:{fontSize:8,color:"#ffa500ba",marginTop:5,textAlign:"center"},children:[c," ",a&&l("a",{onClick:a,children:D})]})]})]}),f("div",{style:{display:"flex",flexDirection:"column",minWidth:400},children:[f("div",{children:[l(T,{rootRef:_,disabled:!r,onClick:()=>o("load",r),children:"LOAD WORLD"}),l(T,{onClick:()=>i("create"),disabled:C,children:"Create New World"})]}),f("div",{children:[l(T,{style:{width:100},disabled:!r,onClick:()=>o("export",r),children:"Export"}),l(T,{style:{width:100},disabled:!r,onClick:()=>o("delete",r),children:"Delete"}),l(T,{style:{width:100},onClick:()=>o("edit",r),disabled:!0,children:"Edit"}),l(T,{style:{width:100},onClick:()=>i("cancel"),children:"Cancel"})]})]})]})]})};try{Singleplayer.displayName="Singleplayer",Singleplayer.__docgenInfo={description:"",displayName:"Singleplayer",props:{worldData:{defaultValue:null,description:"",name:"worldData",required:!0,type:{name:"WorldProps[] | null"}},providers:{defaultValue:null,description:"",name:"providers",required:!0,type:{name:"Record<string, string>"}},activeProvider:{defaultValue:null,description:"",name:"activeProvider",required:!1,type:{name:"string"}},setActiveProvider:{defaultValue:null,description:"",name:"setActiveProvider",required:!1,type:{name:"((provider: string) => void)"}},providerActions:{defaultValue:null,description:"",name:"providerActions",required:!1,type:{name:"Record<string, (() => void) | Element>"}},disabledProviders:{defaultValue:null,description:"",name:"disabledProviders",required:!1,type:{name:"string[]"}},isReadonly:{defaultValue:null,description:"",name:"isReadonly",required:!1,type:{name:"boolean"}},error:{defaultValue:null,description:"",name:"error",required:!1,type:{name:"string"}},warning:{defaultValue:null,description:"",name:"warning",required:!1,type:{name:"string"}},warningAction:{defaultValue:null,description:"",name:"warningAction",required:!1,type:{name:"(() => void)"}},warningActionLabel:{defaultValue:null,description:"",name:"warningActionLabel",required:!1,type:{name:"string"}},onWorldAction:{defaultValue:null,description:"",name:"onWorldAction",required:!0,type:{name:'(action: "load" | "export" | "delete" | "edit", worldName: string) => void'}},onGeneralAction:{defaultValue:null,description:"",name:"onGeneralAction",required:!0,type:{name:'(action: "cancel" | "create") => void'}}}}}catch{}const Fe={component:W,render({open:t}){return l(W,{worldData:Array.from({length:100}).map((i,o)=>({name:"test"+o,title:"Test Save "+o,lastPlayed:Date.now()-6e5,size:1e5})),providerActions:{local(){}},providers:{local:"Local",test:"Test"},onWorldAction:()=>{},onGeneralAction:()=>{}})}},z={args:{}};var K,U,Z;z.parameters={...z.parameters,docs:{...(K=z.parameters)==null?void 0:K.docs,source:{originalSource:`{
  args: {}
}`,...(Z=(U=z.parameters)==null?void 0:U.docs)==null?void 0:Z.source}}};const Ye=["Primary"];export{z as Primary,Ye as __namedExportsOrder,Fe as default};
//# sourceMappingURL=Singleplayer.stories-d34e1abd.js.map
